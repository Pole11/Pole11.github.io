<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>snake</title>
    <script src="/scripts/p5.min.js"></script>
    <link rel="stylesheet" href="/style/style.css">
</head>
<body><!-- <h1 id="pole">Pole</h1> -->

<p style="text-align: center;">
    <img src="/imgs/1000.png" alt="Pole" class="logo-topbar">
    <br>
    <strong class="subtitle-topbar">Trying to find my place in this world by system programming and watching yt videos of people building wooden furniture</strong>
</p>

<hr>
<a href="/">Home</a> |
<a href="/posts/index.html">Posts</a> |
<a href="https://github.com/Pole11">Git</a> |
<a href="/contact.html">Contact</a> |
<a href="/about.html">About me</a> |
<a href="/cv.pdf">CV</a> |
<a href="/stacca-stacca.html">Hacker mode</a> |
<a href="/games/index.html">Random Games</a> 
<hr>


<div id='game-div'><main></main></div><p>end.</p>

<hr />

<p>If you consider this website ugly, please read the <a href="/about.html">about me</a> page</p>

<p>This website is made possibile by the amazing libraries <a href="https://github.com/trentm/python-markdown2">markdown2</a> and <a href="https://asvd.github.io/microlight/">microlight</a> which made my static website generator come to life in <em>uno schiocco di dita</em></p>

<h1 id="note-this-website-is-under-heavy-development-and-yeah-the-posts-dont-have-any-meaning-apart-from-test-purpose">NOTE: This website is under heavy development. And yeah the posts don&#8217;t have any meaning apart from test purpose</h1>
<script defer>let gsize = 0;
let gwidth = 0;
let gheight = 0;
let snakex = 0;
let snakey = 0;
let speed = 0;
let deltaspeed = 0;
let foodx = 0;
let foody = 0;
let snakesize = 0;
let foodsize = 0;
let direction = 0; // 0 means stopped, 1 is up, 2 is right, 3 is down, 4 is left
let body = [];
let tempbody = [];
let points = 0;
let maxpoints = 0;

// Load the image
function preload() {
  img = loadImage('../imgs/superpole.png');
}

function setup() {
    p5Div = document.getElementById("game-div");
    gwidth = elementWidth(p5Div);
    //gheight = Math.min(window.innerHeight, Utils.elementWidth(p5Div) * 3/4); // windowHeight in p5js contains the same information as window.innerHeight
    gheight = window.innerHeight * 9/10; 
    const p5Canvas = createCanvas(gwidth, gheight);
    p5Canvas.parent(p5Div);
    
    gsize = Math.min(gwidth/gheight, gheight/gwidth);
    snakesize = gsize * 40;
    foodsize = gsize * 35;
    snakex = width/2 - snakesize/2;
    snakey = height/2 - snakesize/2;
    direction = 0;
    speed = 4;
    body = [];
    points = 0;
    maxpoints = 0;
    foodx = random(0 + foodsize/2, width - foodsize/2);
    foody = random(0 + foodsize/2, height - foodsize/2);
    deltaspeed = 0.05;
}

function draw() {
    background(220);
    frameRate(60);

    // handle direction
    if (direction == 1) {
        snakey -= speed;
    } else if (direction == 2) {
        snakex += speed;
    } else if (direction == 3) {
        snakey += speed;
    } else if (direction == 4) {
        snakex -= speed;
    }

    // pacman effect
    if (snakex > width) {
        snakex = -snakesize;
    } else if (snakex < -snakesize) {
        snakex = width;
    }

    if (snakey > height) {
        snakey = -snakesize;
    } else if (snakey < -snakesize) {
        snakey = height;
    }

    // body
    noStroke();
    fill("#009900");
    for (let i = body.length - 1; i > 0; i--) {
        body[i].x = body[i - 1].x;
        body[i].y = body[i - 1].y;
        square(body[i].x, body[i].y, snakesize);
    }
    body[0] = {"x": snakex, "y": snakey};

    // check if food eaten
    if (snakex > foodx - foodsize/2 && snakex < foodx + foodsize/2 && snakey > foody - foodsize/2 && snakey < foody + foodsize/2) {
        foodx = random(0 + foodsize/2, width - foodsize/2);
        foody = random(0 + foodsize/2, height - foodsize/2);
        points++;
        if (points > maxpoints) maxpoints = points; 
        body.push({"x": snakex, "y": snakey});
        speed += deltaspeed;
    }

    stroke("#000000");
    strokeWeight(1);
    fill("#ff0000");
    square(foodx, foody, foodsize);

    fill("#00ff00");
    square(snakex, snakey, snakesize);
}

function keyPressed() {
    if (key === 'w') { // up
        if (direction != 3) {
            direction = 1;
        }
    } else if (key == 'd') { // right
        if (direction != 4) {
            direction = 2;
        }
    } else if (key == 's') { // down
        if (direction != 1) {
            direction = 3;
        }
    } else if (key == 'a') { // left
        if (direction != 2) {
            direction = 4;
        }
    }
}

function touchStarted() {
    // handle touch
    let m = width / height;
    for (let touch of touches) {
        // use touch.x touch.y
        if (m * touch.x - height/2 > touch.y) {
            if (-m * touch.x < touch.y) {
                // left
                direction = 4;
            } else {
                // up
                direction = 1;
            }
        } else {
            if (-m * touch.x < touch.y) {
                // down
                direction = 3;
            } else {
                // up
                direction = 1;
            }
        }
    }
}

// Calculate the Width in pixels of a Dom element
function elementWidth(element) {
    return (
        element.clientWidth -
        parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-left")) -
        parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-right"))
    )
}

// Calculate the Height in pixels of a Dom element
function elementHeight(element) {
    return (
        element.clientHeight -
        parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-top")) -
        parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-bottom"))
    )
}
</script><script src="/scripts/microlight.js"></script>
</body>
</html>